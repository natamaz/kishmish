!function(a){a.addModule(function(a){"use strict";return{name:"Number",selector:'input[type="number"]',options:{realElementClass:"jcf-real-element",fakeStructure:'<span class="jcf-number"><span class="jcf-btn-inc"></span><span class="jcf-btn-dec"></span></span>',btnIncSelector:".jcf-btn-inc",btnDecSelector:".jcf-btn-dec",pressInterval:150},matchElement:function(a){return a.is(this.selector)},init:function(){this.initStructure(),this.attachEvents(),this.refresh()},initStructure:function(){this.page=a("html"),this.realElement=a(this.options.element).addClass(this.options.realElementClass),this.fakeElement=a(this.options.fakeStructure).insertBefore(this.realElement).prepend(this.realElement),this.btnDec=this.fakeElement.find(this.options.btnDecSelector),this.btnInc=this.fakeElement.find(this.options.btnIncSelector),this.initialValue=parseFloat(this.realElement.val())||0,this.minValue=parseFloat(this.realElement.attr("min")),this.maxValue=parseFloat(this.realElement.attr("max")),this.stepValue=parseFloat(this.realElement.attr("step"))||1,this.minValue=isNaN(this.minValue)?-(1/0):this.minValue,this.maxValue=isNaN(this.maxValue)?1/0:this.maxValue,isFinite(this.maxValue)&&(this.maxValue-=(this.maxValue-this.minValue)%this.stepValue)},attachEvents:function(){this.realElement.on({focus:this.onFocus}),this.btnDec.add(this.btnInc).on("jcf-pointerdown",this.onBtnPress)},onBtnPress:function(a){var b,c=this;this.realElement.is(":disabled")||(b=this.btnInc.is(a.currentTarget),c.step(b),clearInterval(this.stepTimer),this.stepTimer=setInterval(function(){c.step(b)},this.options.pressInterval),this.page.on("jcf-pointerup",this.onBtnRelease))},onBtnRelease:function(){clearInterval(this.stepTimer),this.page.off("jcf-pointerup",this.onBtnRelease)},onFocus:function(){this.fakeElement.addClass(this.options.focusClass),this.realElement.on({blur:this.onBlur,keydown:this.onKeyPress})},onBlur:function(){this.fakeElement.removeClass(this.options.focusClass),this.realElement.off({blur:this.onBlur,keydown:this.onKeyPress})},onKeyPress:function(a){(38===a.which||40===a.which)&&(a.preventDefault(),this.step(38===a.which))},step:function(a){var b=parseFloat(this.realElement.val()),c=b||0,d=this.stepValue*(a?1:-1),e=isFinite(this.minValue)?this.minValue:this.initialValue-Math.abs(c*this.stepValue),f=Math.abs(e-c)%this.stepValue;f?a?c+=d-f:c-=f:c+=d,c<this.minValue?c=this.minValue:c>this.maxValue&&(c=this.maxValue),c!==b&&(this.realElement.val(c).trigger("change"),this.refresh())},refresh:function(){var a=this.realElement.is(":disabled"),b=parseFloat(this.realElement.val());this.fakeElement.toggleClass(this.options.disabledClass,a),this.btnDec.toggleClass(this.options.disabledClass,b===this.minValue),this.btnInc.toggleClass(this.options.disabledClass,b===this.maxValue)},destroy:function(){this.realElement.removeClass(this.options.realElementClass).insertBefore(this.fakeElement),this.fakeElement.remove(),clearInterval(this.stepTimer),this.page.off("jcf-pointerup",this.onBtnRelease),this.realElement.off({keydown:this.onKeyPress,focus:this.onFocus,blur:this.onBlur})}}})}(jcf);